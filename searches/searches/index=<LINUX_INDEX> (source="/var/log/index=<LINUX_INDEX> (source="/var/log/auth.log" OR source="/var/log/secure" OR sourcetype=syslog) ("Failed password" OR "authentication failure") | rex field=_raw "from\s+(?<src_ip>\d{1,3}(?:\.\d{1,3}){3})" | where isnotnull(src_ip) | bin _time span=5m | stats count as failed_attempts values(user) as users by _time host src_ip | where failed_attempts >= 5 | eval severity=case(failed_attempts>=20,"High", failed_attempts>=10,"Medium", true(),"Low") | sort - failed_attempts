index=<LINUX_INDEX> (source="/var/log/auth.log" OR source="/var/log/secure" OR sourcetype=syslog) ("Failed password" OR "authentication failure")
| rex field=_raw "from\s+(?<src_ip>\d{1,3}(?:\.\d{1,3}){3})"
| where isnotnull(src_ip)
| bin _time span=5m
| stats count as failed_attempts values(user) as users by _time host src_ip
| where failed_attempts >= 5
| eval severity=case(failed_attempts>=20,"High", failed_attempts>=10,"Medium", true(),"Low")
| sort - failed_attempts
